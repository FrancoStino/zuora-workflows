---
title: Development Guide
description: Local development setup, testing, and contribution workflow
---

import { PrerequisitesCheck } from '@/components/prerequisites-check'
import { CodeExample } from '@/components/code-example'
import { TestingSection } from '@/components/testing-section'
import { DebuggingSection } from '@/components/debugging-section'
import { GitWorkflow } from '@/components/git-workflow'
import { NextSteps } from '@/components/next-steps'

# Development Guide

This guide covers local development setup, testing, and contributing to Zuora Workflow Manager.

## Local Development Setup

<PrerequisitesCheck
  items={[
    { name: 'Lando', url: 'https://lando.dev', installed: false },
    { name: 'Docker', url: 'https://docker.com/', installed: false },
    { name: 'Node.js', url: 'https://nodejs.org/', version: '24.0+', installed: false },
    { name: 'Yarn', url: 'https://yarnpkg.com/', installed: false },
    { name: 'Git', url: 'https://git-scm.com/', installed: false }
  ]}
/>

### Initial Setup

<Steps steps={[
  { title: 'Clone Repository', command: 'git clone https://github.com/FrancoStino/zuora-workflows.git && cd zuora-workflows' },
  { title: 'Start Lando', command: 'lando start', description: 'Auto-runs composer install' },
  { title: 'Install Dependencies', command: 'yarn install' },
  { title: 'Configure Environment', command: 'cp .env.example .env && lando artisan key:generate && lando artisan migrate' },
  { title: 'Build Assets', command: 'yarn run build' }
]} />

### Start Development Services

<CodeBlock
  title="Development Terminals"
  tabs={[
    {
      name: 'Terminal 1 - Queue',
      code: 'lando queue',
      language: 'bash'
    },
    {
      name: 'Terminal 2 - Scheduler',
      code: 'lando schedule',
      language: 'bash'
    },
    {
      name: 'Terminal 3 - Assets',
      code: 'yarn run dev',
      language: 'bash'
    }
  ]}
/>

## Development Workflow

### Daily Development Flow

<Steps steps={[
  'Pull latest changes: git pull origin main',
  'Install new dependencies: lando composer install && yarn install',
  'Run migrations: lando artisan migrate',
  'Create feature branch: git checkout -b feature/your-feature-name',
  'Make changes and rebuild assets',
  'Run tests: lando test',
  'Commit: git commit -m "feat: add new feature"',
  'Push and create PR: git push origin feature/your-feature-name'
]} />

## Code Structure

### Adding New Filament Resources

<CodeExample
  title="Create Filament Resource"
  steps={[
    {
      title: 'Create Resource',
      code: 'lando artisan make:filament-resource YourResource',
      language: 'bash'
    },
    {
      title: 'Define Resource',
      code: `<?php

namespace App\\Filament\\Resources;

use App\\Filament\\Resources\\YourResource\\Pages;
use App\\Models\\YourModel;
use Filament\\Forms\\Form;
use Filament\\Resources\\Resource;
use Filament\\Tables\\Table;

class YourResource extends Resource
{
    protected static ?string \$model = YourModel::class;
    protected static ?string \$navigationIcon = 'heroicon-o-cube';

    public static function form(Form \$form): Form
    {
        return \$form
            ->schema([
                // Define form fields
            ]);
    }

    public static function table(Table \$table): Table
    {
        return \$table
            ->columns([
                // Define table columns
            ])
            ->filters([
                // Define filters
            ])
            ->actions([
                // Define actions
            ]);
    }

    public static function getPages(): array
    {
        return [
            'index' => Pages\\ListYours::route('/'),
            'create' => Pages\\CreateYour::route('/create'),
            'edit' => Pages\\EditYour::route('/{record}/edit'),
            'view' => Pages\\ViewYour::route('/{record}'),
        ];
    }
}`,
      language: 'php'
    },
    {
      title: 'Create Pages',
      code: 'lando artisan make:filament-page YourResource/ViewYour --resource=YourResource',
      language: 'bash'
    },
    {
      title: 'Add Permissions',
      code: `// Add to config/filament-shield.php
'resources' => [
    'App\\\\Filament\\\\Resources\\\\YourResource',
],`,
      language: 'php'
    }
  ]}
/>

### Adding New Services

<CodeExample
  title="Create Service Class"
  steps={[
    {
      title: 'Create Service',
      code: `<?php

namespace App\\Services;

use Exception;
use Illuminate\\Support\\Facades\\Log;

class YourService
{
    public function doSomething(array \$data): array
    {
        try {
            // Your business logic here
            return [
                'success' => true,
                'data' => \$data,
            ];
        } catch (Exception \$e) {
            Log::error('Service error', [
                'error' => \$e->getMessage(),
                'trace' => \$e->getTraceAsString(),
            ]);

            throw \$e;
        }
    }
}`,
      language: 'php'
    },
    {
      title: 'Use in Controller/Job',
      code: `use App\\Services\\YourService;

public function __construct(
    private YourService \$yourService
) {}

public function handle()
{
    \$result = \$this->yourService->doSomething([
        'key' => 'value',
    ]);
}`,
      language: 'php'
    }
  ]}
/>

### Adding New Queue Jobs

<CodeExample
  title="Create Queue Job"
  steps={[
    {
      title: 'Create Job',
      code: `<?php

namespace App\\Jobs;

use App\\Services\\YourService;
use Illuminate\\Bus\\Queueable;
use Illuminate\\Contracts\\Queue\\ShouldQueue;
use Illuminate\\Foundation\\Bus\\Dispatchable;
use Illuminate\\Queue\\InteractsWithQueue;
use Illuminate\\Queue\\SerializesModels;
use Illuminate\\Support\\Facades\\Log;

class YourJob implements ShouldQueue
{
    use Dispatchable, InteractsWithQueue, Queueable, SerializesModels;

    public \$tries = 3;
    public \$backoff = [60, 120, 180];
    public \$queue = 'default';

    public function __construct(
        public array \$data
    ) {}

    public function handle(YourService \$service): void
    {
        try {
            \$service->processData(\$this->data);

            Log::info('Job completed successfully', [
                'job' => self::class,
                'data' => \$this->data,
            ]);
        } catch (\\Exception \$e) {
            Log::error('Job failed', [
                'job' => self::class,
                'error' => \$e->getMessage(),
            ]);

            \$this->fail(\$e);
        }
    }
}`,
      language: 'php'
    },
    {
      title: 'Dispatch Job',
      code: `use App\\Jobs\\YourJob;

// Dispatch immediately
YourJob::dispatch(\$data);

// Dispatch with delay
YourJob::dispatch(\$data)->delay(now()->addMinutes(5));

// Dispatch to specific queue
YourJob::dispatch(\$data)->onQueue('high-priority');`,
      language: 'php'
    }
  ]}
/>

## Testing

<TestingSection />

### Running Tests

<CodeBlock
  title="Test Commands"
  tabs={[
    { name: 'All Tests', code: 'lando test', language: 'bash' },
    { name: 'Verbose', code: 'lando artisan test -v', language: 'bash' },
    { name: 'Specific Test', code: 'lando artisan test tests/Feature/YourTest.php', language: 'bash' },
    { name: 'With Coverage', code: 'lando artisan test --coverage', language: 'bash' },
    { name: 'Parallel', code: 'lando artisan test --parallel', language: 'bash' }
  ]}
/>

### Writing Tests

<CodeExample
  title="Feature Test Example"
  steps={[
    {
      title: 'Create Feature Test',
      code: `<?php

namespace Tests\\Feature;

use App\\Models\\Customer;
use App\\Models\\User;
use Illuminate\\Foundation\\Testing\\RefreshDatabase;
use Tests\\TestCase;

class WorkflowSyncTest extends TestCase
{
    use RefreshDatabase;

    protected function setUp(): void
    {
        parent::setUp();

        // Create admin user
        \$this->admin = User::factory()->create();
        \$this->admin->assignRole('super_admin');

        // Authenticate
        \$this->actingAs(\$this->admin);
    }

    /** @test */
    public function it_can_sync_workflows_for_customer(): void
    {
        // Create customer
        \$customer = Customer::factory()->create([
            'zuora_client_id' => 'test_id',
            'zuora_client_secret' => 'test_secret',
            'zuora_base_url' => 'https://rest.test.zuora.com',
        ]);

        // Dispatch sync job
        \$this->post(route('filament.resources.customers.sync', \$customer->id))
            ->assertStatus(200);

        // Assert job was dispatched
        \$this->assertDatabaseHas('jobs', [
            'queue' => 'default',
        ]);
    }
}`,
      language: 'php'
    }
  ]}
/>

<CodeExample
  title="Unit Test Example"
  steps={[
    {
      title: 'Create Unit Test',
      code: `<?php

namespace Tests\\Unit;

use App\\Services\\ZuoraService;
use Illuminate\\Support\\Facades\\Http;
use Tests\\TestCase;

class ZuoraServiceTest extends TestCase
{
    protected ZuoraService \$service;

    protected function setUp(): void
    {
        parent::setUp();

        \$this->service = new ZuoraService();
    }

    /** @test */
    public function it_gets_access_token(): void
    {
        // Mock HTTP response
        Http::fake([
            '*/oauth/token' => Http::response([
                'access_token' => 'test_token',
                'token_type' => 'Bearer',
                'expires_in' => 3600,
            ], 200),
        ]);

        // Call service method
        \$token = \$this->service->getAccessToken(
            'client_id',
            'client_secret',
            'https://rest.zuora.com'
        );

        // Assert token returned
        \$this->assertEquals('test_token', \$token);
    }
}`,
      language: 'php'
    }
  ]}
/>

<Alert type="info">
  <strong>Test Database:</strong> Use separate database for testing:
  <CodeBlock
    code={`<env name="DB_CONNECTION" value="sqlite"/>
<env name="DB_DATABASE" value=":memory:"/>`}
    language="xml"
    showCopy={false}
  />
</Alert>

## Debugging

<DebuggingSection />

### Debugbar

<Alert type="info">
  <strong>Enable Laravel Debugbar:</strong>
  <CodeBlock code="DEBUGBAR_ENABLED=true" language="env" showCopy={false} />
</Alert>

<InfoCards
  cards={[
    { title: 'Queries Executed', description: 'View all database queries' },
    { title: 'Request Duration', description: 'Track page load time' },
    { title: 'View Data', description: 'Inspect passed data to views' },
    { title: 'Timeline', description: 'Visualize request lifecycle' },
    { title: 'Exceptions', description: 'View caught exceptions' }
  ]}
/>

### Xdebug

<CodeBlock
  title="VS Code Configuration (.vscode/launch.json)"
  code={`{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Listen for Xdebug",
      "type": "php",
      "request": "launch",
      "port": 9003,
      "pathMappings": {
        "/app": "\${workspaceFolder}/app"
      }
    }
  ]
}`}
  language="json"
/>

### Logging

<CodeExample
  title="Custom Logging"
  steps={[
    {
      title: 'Log Levels',
      code: `use Illuminate\\Support\\Facades\\Log;

Log::emergency('Critical issue');
Log::alert('Alert message');
Log::critical('Critical failure');
Log::error('Error occurred');
Log::warning('Warning message');
Log::notice('Notice message');
Log::info('Information');
Log::debug('Debug info');`,
      language: 'php'
    },
    {
      title: 'Log with Context',
      code: `Log::info('User logged in', [
    'user_id' => \$user->id,
    'ip' => request()->ip(),
]);`,
      language: 'php'
    }
  ]}
/>

### Tinker

<Alert type="info">
  <strong>Interactive REPL:</strong> <Code inline>lando artisan tinker</Code>
</Alert>

<CodeBlock
  title="Tinker Examples"
  code={`// Test model queries
>>> App\\Models\\Customer::first()
>>> App\\Models\\Workflow::where('state', 'Active')->count()

// Test services
>>> \$service = new App\\Services\\ZuoraService();
>>> \$service->getAccessToken('id', 'secret', 'https://rest.zuora.com')

// Test jobs
>>> App\\Jobs\\SyncCustomersJob::dispatch(App\\Models\\Customer::first())`}
  language="php"
/>

## Code Style

### PHP Code Style

<CodeBlock
  title="Laravel Pint"
  tabs={[
    {
      name: 'Check',
      code: './vendor/bin/pint --test',
      language: 'bash'
    },
    {
      name: 'Fix',
      code: './vendor/bin/pint',
      language: 'bash'
    }
  ]}
/>

### PHPStan

<CodeBlock
  code="./vendor/bin/phpstan analyse"
  language="bash"
  title="Static Analysis"
/>

### JavaScript/TypeScript

<CodeBlock
  title="ESLint & Prettier"
  tabs={[
    { name: 'Check Style', code: 'npx eslint resources/js', language: 'bash' },
    { name: 'Fix Style', code: 'npx eslint resources/js --fix', language: 'bash' },
    { name: 'Format', code: 'npx prettier --write .', language: 'bash' }
  ]}
/>

## Git Workflow

<GitWorkflow />

### Branching Strategy

<DataTable
  columns={['Branch', 'Purpose']}
  rows={[
    ['main', 'Production branch (protected)'],
    ['develop', 'Development branch'],
    ['feature/*', 'Feature branches'],
    ['bugfix/*', 'Bug fix branches'],
    ['hotfix/*', 'Emergency fixes']
  ]}
/>

### Commit Messages

Follow Conventional Commits:

<CodeBlock
  title="Commit Message Format"
  code={`<type>(<scope>): <subject>

<body>

<footer>`}
  language="text"
/>

<DataTable
  columns={['Type', 'Description']}
  rows={[
    ['feat', 'New feature'],
    ['fix', 'Bug fix'],
    ['docs', 'Documentation changes'],
    ['style', 'Code style changes (formatting)'],
    ['refactor', 'Code refactoring'],
    ['test', 'Adding or updating tests'],
    ['chore', 'Maintenance tasks']
  ]}
/>

<CodeExample
  title="Commit Message Examples"
  steps={[
    {
      title: 'Feature',
      code: `feat(workflow): add graphical view for workflows

- Implement JointJS integration
- Add Dagre layout algorithm
- Add zoom controls

Closes #123`,
      language: 'text'
    },
    {
      title: 'Bug Fix',
      code: `fix(auth): resolve OAuth token caching issue

Tokens were not being cached properly, causing
excessive API calls. Updated cache key generation.

Fixes #456`,
      language: 'text'
    }
  ]}
/>

## Contributing Guidelines

<Steps steps={[
  'Check existing issues on GitHub',
  'Comment on issue you want to work on',
  'Create feature branch from main',
  'Make your changes',
  'Add tests for new functionality',
  'Update documentation if needed',
  'Submit Pull Request'
]} />

### Pull Request Checklist

<Checklist
  items={[
    'Code follows project style guide',
    'Tests pass (lando test)',
    'No PHPStan errors',
    'No linting errors',
    'Documentation updated',
    'Commit messages follow convention',
    'PR description includes what and why',
    'No merge conflicts'
  ]}
/>

## Common Development Tasks

<CodeExample
  title="Common Tasks"
  steps={[
    {
      title: 'Add Migration',
      code: `// Create migration
lando artisan make:migration create_new_table

// Edit migration file
public function up(): void
{
    Schema::create('new_table', function (Blueprint \$table) {
        \$table->id();
        \$table->string('name');
        \$table->timestamps();
        \$table->foreignId('customer_id')
            ->nullable()
            ->constrained()
            ->onDelete('cascade');
    });
}

// Run migration
lando artisan migrate`,
      language: 'php'
    },
    {
      title: 'Add Model',
      code: `// Create model
lando artisan make:model YourModel

// Add fillable and casts
protected \$fillable = ['name', 'email', 'phone'];
protected \$casts = ['email_verified_at' => 'datetime'];`,
      language: 'php'
    },
    {
      title: 'Add Command',
      code: `// Create command
lando artisan make:command SyncSomething

// Implement signature
protected \$signature = 'app:sync-something {--all}';

// Implement handle
public function handle(): int
{
    \$this->info('Starting sync...');
    // Your logic here
    \$this->info('Sync completed!');
    return self::SUCCESS;
}`,
      language: 'php'
    }
  ]}
/>

## Performance Optimization

### Database Queries

<CodeExample
  title="Eager Loading"
  steps={[
    {
      title: 'Bad: N+1 Queries',
      code: `\$workflows = Workflow::all();
foreach (\$workflows as \$workflow) {
    echo \$workflow->customer->name; // Separate query each time
}`,
      language: 'php'
    },
    {
      title: 'Good: Single Query',
      code: `\$workflows = Workflow::with('customer')->get();
foreach (\$workflows as \$workflow) {
    echo \$workflow->customer->name;
}`,
      language: 'php'
    }
  ]}
/>

### Caching

<CodeExample
  title="Cache Implementation"
  steps={[
    {
      title: 'Cache Expensive Operations',
      code: `use Illuminate\\Support\\Facades\\Cache;

\$workflows = Cache::remember('workflows.all', 3600, function () {
    return Workflow::with('customer')->get();
});`,
      language: 'php'
    }
  ]}
/>

## Security Best Practices

<Checklist
  items={[
    'Never commit secrets (API keys, passwords)',
    'Always use parameterized queries (Eloquent does this automatically)',
    'Validate and sanitize all user inputs',
    'Use Laravel\'s built-in security features (Auth, Gates, Policies)',
    'Keep dependencies updated',
    'Use HTTPS in production'
  ]}
/>

<NextSteps
  links={[
    { title: 'Features Guide', href: '../guides/features', description: 'Learn about features' },
    { title: 'API Reference', href: '../reference/api', description: 'API documentation' },
    { title: 'Deployment Guide', href: '../guides/deployment', description: 'Deploy to production' }
  ]}
/>

## Related Documentation

<LinksGrid
  links={[
    { title: 'Laravel Documentation', url: 'https://laravel.com/docs/12.x', icon: 'ðŸ“š' },
    { title: 'Filament Documentation', url: 'https://filamentphp.com/docs/4.x', icon: 'ðŸŽ¨' },
    { title: 'PHPUnit Documentation', url: 'https://phpunit.de/documentation.html', icon: 'ðŸ§ª' },
    { title: 'Lando Documentation', url: 'https://docs.lando.dev/', icon: 'ðŸ³' }
  ]}
/>
