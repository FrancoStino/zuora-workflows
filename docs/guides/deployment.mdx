---
title: Deployment Guide
description: Production deployment and CI/CD pipeline setup
---

import { DeploymentDiagram } from '@/components/deployment-diagram'
import { RequirementsCard } from '@/components/requirements-card'
import { DeploymentMethods } from '@/components/deployment-methods'
import { ServerConfig } from '@/components/server-config'
import { PostDeployment } from '@/components/post-deployment'
import { MonitoringSection } from '@/components/monitoring-section'
import { BackupStrategy } from '@/components/backup-strategy'
import { TroubleshootingSection } from '@/components/troubleshooting-section'
import { NextSteps } from '@/components/next-steps'

# Deployment Guide

This guide covers deploying Zuora Workflow Manager to production environments.

## Deployment Overview

The application is designed to be deployed to standard PHP hosting environments.

<DeploymentDiagram />

### Deployment Methods

<DeploymentMethods
  methods={[
    {
      name: 'GitHub Actions',
      description: 'CI/CD (recommended)',
      recommended: true
    },
    {
      name: 'Manual SSH/FTP',
      description: 'Manual deployment',
      recommended: false
    },
    {
      name: 'Platform-specific',
      description: 'Forge, Vapor, etc.',
      recommended: false
    }
  ]}
/>

## Prerequisites

<RequirementsCard
  title="Server Requirements"
  requirements={[
    { name: 'PHP', version: '8.4+', required: true },
    { name: 'Composer', version: '2.x', required: true },
    { name: 'Node.js', version: '24.0+', required: true },
    { name: 'Yarn', version: 'Latest', required: true },
    { name: 'MariaDB', version: '11.4+', required: true },
    { name: 'Redis', version: '7.0+', required: false, description: 'Recommended' },
    { name: 'Nginx/Apache', version: 'Latest', required: true },
    { name: 'SSL Certificate', version: '-', required: true, description: 'HTTPS required' }
  ]}
/>

### PHP Extensions

<CodeBlock
  title="Check PHP Extensions"
  code="php -m | grep -E \"(mbstring|openssl|pdo|tokenizer|xml|ctype|json|bcmath|redis)\""
  language="bash"
/>

<Alert type="info">
  <strong>Required Extensions:</strong> bcmath, ctype, fileinfo, json, mbstring, openssl, pdo, tokenizer, xml, redis (optional, recommended)
</Alert>

## Option A: GitHub Actions Deployment

### Setup Repository Secrets

Navigate to GitHub repository â†’ Settings â†’ Secrets and variables â†’ Actions

<DataTable
  columns={['Secret', 'Description']}
  rows={[
    ['SSH_PRIVATE_KEY', 'Private SSH key for server access'],
    ['SSH_HOST', 'Server IP/hostname'],
    ['SSH_USERNAME', 'SSH username'],
    ['APP_KEY', 'Laravel APP_KEY'],
    ['DB_DATABASE', 'Production database name'],
    ['DB_USERNAME', 'Database username'],
    ['DB_PASSWORD', 'Database password'],
    ['DB_HOST', 'Database server host']
  ]}
/>

### Deployment Workflow

<FlowDiagram type="ci-cd-pipeline" title="CI/CD Pipeline" />

<Steps steps={[
  'Checkout code',
  'Setup PHP',
  'Install dependencies',
  'Build assets',
  'Run migrations',
  'Clear caches',
  'Restart services'
]} />

<Alert type="info">
  <strong>Trigger Deployment:</strong>
  <ol className="list-decimal list-inside mt-2 space-y-1">
    <li>Navigate to Actions tab in GitHub</li>
    <li>Select Deploy to Production workflow</li>
    <li>Click Run workflow</li>
    <li>Select branch and click Run workflow</li>
  </ol>
</Alert>

## Option B: Manual Deployment

<ServerConfig />

### Step 1: Prepare Server

<CodeBlock
  title="Install Dependencies"
  code={`# Install PHP
sudo apt install php8.4 php8.4-fpm php8.4-mysql php8.4-xml php8.4-mbstring php8.4-curl php8.4-zip php8.4-bcmath php8.4-intl

# Install Composer
curl -sS https://getcomposer.org/installer | php
sudo mv composer.phar /usr/local/bin/composer

# Install Node.js and Yarn
curl -fsSL https://deb.nodesource.com/setup_24.x | sudo -E bash -
sudo apt-get install -y nodejs
npm install -g yarn

# Install Redis (optional)
sudo apt install redis-server`}
  language="bash"
/>

### Step 2: Configure Environment

<Steps steps={[
  'Clone repository: cd /var/www && git clone https://github.com/FrancoStino/zuora-workflows.git zuora-workflows && cd zuora-workflows',
  'Copy environment file: cp .env.example .env',
  'Edit .env file with production values',
  'Generate application key: php artisan key:generate'
]} />

<CodeBlock
  title=".env Configuration"
  code={`APP_NAME="Zuora Workflows"
APP_ENV=production
APP_KEY=base64:YOUR_32_CHAR_KEY
APP_DEBUG=false
APP_URL=https://your-domain.com

DB_CONNECTION=mariadb
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=zuora_workflows
DB_USERNAME=zuora_user
DB_PASSWORD=secure_password

CACHE_STORE=redis
QUEUE_CONNECTION=redis
REDIS_HOST=127.0.0.1
REDIS_PORT=6379`}
  language="env"
/>

### Step 3: Install Dependencies & Build

<CodeBlock
  title="Dependencies & Assets"
  code={`# Install PHP dependencies
composer install --optimize-autoloader --no-dev

# Install Node.js dependencies
yarn install --production

# Build assets
yarn run build`}
  language="bash"
/>

### Step 4: Database Setup

<CodeBlock
  title="Database Creation"
  code={`mysql -u root -p

CREATE DATABASE zuora_workflows CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'zuora_user'@'localhost' IDENTIFIED BY 'secure_password';
GRANT ALL PRIVILEGES ON zuora_workflows.* TO 'zuora_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;`}
  language="sql"
/>

<CodeBlock
  title="Run Migrations"
  code="php artisan migrate --force"
  language="bash"
/>

### Step 5: Configure Web Server

<CodeExample
  title="Nginx Configuration"
  steps={[
    {
      title: 'Create /etc/nginx/sites-available/zuora-workflows',
      code: `server {
    listen 80;
    listen [::]:80;
    server_name your-domain.com;
    return 301 https://\$server_name\$request_uri;
}

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name your-domain.com;

    root /var/www/zuora-workflows/public;
    index index.php;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    location / {
        try_files \$uri \$uri/ /index.php?\$query_string;
    }

    location ~ \.php\$ {
        fastcgi_pass unix:/var/run/php/php8.4-fpm.sock;
        fastcgi_param SCRIPT_FILENAME \$realpath_root\$fastcgi_script_name;
        include fastcgi_params;
    }

    location ~ /\\.(?!well-known).* {
        deny all;
    }
}`,
      language: 'nginx'
    },
    {
      title: 'Enable site',
      code: `sudo ln -s /etc/nginx/sites-available/zuora-workflows /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx`,
      language: 'bash'
    }
  ]}
/>

<CodeExample
  title="Apache Configuration"
  steps={[
    {
      title: 'Create VirtualHost',
      code: `<VirtualHost *:80>
    ServerName your-domain.com
    Redirect permanent / https://your-domain.com/
</VirtualHost>

<VirtualHost *:443>
    ServerName your-domain.com
    DocumentRoot /var/www/zuora-workflows/public

    SSLEngine on
    SSLCertificateFile /path/to/cert.pem
    SSLCertificateKeyFile /path/to/key.pem

    <Directory /var/www/zuora-workflows/public>
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>`,
      language: 'apache'
    },
    {
      title: 'Enable site',
      code: `sudo a2ensite zuora-workflows
sudo systemctl reload apache2`,
      language: 'bash'
    }
  ]}
/>

### Step 6: Set Permissions

<CodeBlock
  title="File Permissions"
  code={`sudo chown -R www-data:www-data /var/www/zuora-workflows
sudo chmod -R 755 /var/www/zuora-workflows
sudo chmod -R 775 /var/www/zuora-workflows/storage
sudo chmod -R 775 /var/www/zuora-workflows/bootstrap/cache`}
  language="bash"
/>

### Step 7: Configure Queue Worker

<CodeExample
  title="Supervisor Configuration"
  steps={[
    {
      title: 'Create /etc/supervisor/conf.d/zuora-workflows.conf',
      code: `[program:zuora-workflows-queue]
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/zuora-workflows/artisan queue:work redis --sleep=3 --tries=3
autostart=true
autorestart=true
user=www-data
numprocs=2
redirect_stderr=true
stdout_logfile=/var/www/zuora-workflows/storage/logs/queue-worker.log
stopwaitsecs=3600`,
      language: 'ini'
    },
    {
      title: 'Start Supervisor',
      code: `sudo supervisorctl reread
sudo supervisorctl update
sudo supervisorctl start zuora-workflows-queue:*`,
      language: 'bash'
    }
  ]}
/>

<CodeBlock
  title="Alternative: Cron Job"
  code={`# Add to crontab
crontab -e

# Cron entry
* * * * * * php /var/www/zuora-workflows/artisan schedule:run >> /dev/null 2>&1`}
  language="bash"
/>

## Post-Deployment

<PostDeployment />

### Create Admin Account

<CodeBlock
  title="Create Admin via Tinker"
  code={`php artisan tinker

>>> \\App\\Models\\User::create([
...     'name' => 'Admin User',
...     'email' => 'admin@your-domain.com',
...     'password' => bcrypt('secure_password'),
... ])`}
  language="bash"
/>

### Verify Deployment

<Checklist
  items={[
    'Login page (or setup wizard if first visit) displays correctly',
    'No 404 errors on assets',
    'Assets loading correctly',
    'Database connections working',
    'Queue worker processing jobs'
  ]}
/>

<Alert type="info">
  <strong>Access your domain:</strong> <Code inline>https://your-domain.com/admin</Code>
</Alert>

## Queue Configuration

<DataTable
  columns={['Environment', 'Configuration']}
  rows={[
    ['Development (immediate)', 'QUEUE_CONNECTION=sync'],
    ['Development (queue worker)', 'QUEUE_CONNECTION=database'],
    ['Production (recommended)', 'QUEUE_CONNECTION=redis']
  ]}
/>

<CodeBlock
  title="Run Queue Worker"
  tabs={[
    {
      name: 'Database Queue',
      code: 'php artisan queue:work --tries=3 --backoff=60',
      language: 'bash'
    },
    {
      name: 'Redis Queue',
      code: 'php artisan queue:work redis --tries=3 --backoff=60',
      language: 'bash'
    }
  ]}
/>

## Monitoring

<MonitoringSection />

### Logs

<CodeBlock
  title="View Logs"
  tabs={[
    {
      name: 'Application Logs',
      code: 'tail -f /var/www/zuora-workflows/storage/logs/laravel.log',
      language: 'bash'
    },
    {
      name: 'Queue Worker Logs',
      code: 'tail -f /var/www/zuora-workflows/storage/logs/queue-worker.log',
      language: 'bash'
    }
  ]}
/>

### Failed Jobs

<CodeBlock
  title="Failed Jobs Management"
  tabs={[
    {
      name: 'Check Failed Jobs',
      code: 'php artisan queue:failed',
      language: 'bash'
    },
    {
      name: 'Retry All',
      code: 'php artisan queue:retry all',
      language: 'bash'
    },
    {
      name: 'Flush Failed Jobs',
      code: 'php artisan queue:flush',
      language: 'bash'
    }
  ]}
/>

## Security

### SSL Certificate

<CodeBlock
  title="Let\'s Encrypt Setup"
  code={`sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com`}
  language="bash"
/>

### Firewall Configuration

<CodeBlock
  title="UFW Setup"
  code={`sudo ufw allow 22/tcp   # SSH
sudo ufw allow 80/tcp   # HTTP
sudo ufw allow 443/tcp  # HTTPS
sudo ufw enable`}
  language="bash"
/>

### Security Headers

<CodeBlock
  title="Nginx Security Headers"
  code={`add_header X-Frame-Options "SAMEORIGIN";
add_header X-XSS-Protection "1; mode=block";
add_header X-Content-Type-Options "nosniff";
add_header Referrer-Policy "strict-origin-when-cross-origin";
add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline';";`}
  language="nginx"
/>

## Backup Strategy

<BackupStrategy />

### Database Backup

<CodeBlock
  title="Automated Database Backup"
  code={`# Daily backup cron
0 2 * * * * mysqldump -u zuora_user -p'secure_password' zuora_workflows | gzip > /backups/zuora-workflows-\$(date +%Y%m%d).sql.gz

# Keep 30 days of backups
0 3 * * * * find /backups -name "*.sql.gz" -mtime +30 -delete`}
  language="bash"
/>

### Application Backup

<CodeBlock
  title="Application Files Backup"
  code={`tar -czf /backups/app-\$(date +%Y%m%d).tar.gz \\
    /var/www/zuora-workflows/storage \\
    /var/www/zuora-workflows/.env`}
  language="bash"
/>

## Troubleshooting

<TroubleshootingSection
  problems={[
    {
      title: '500 Internal Server Error',
      solution: 'Check logs: tail -f /var/www/zuora-workflows/storage/logs/laravel.log',
      commonCauses: ['Missing PHP extensions', 'Incorrect permissions', 'Database connection issues', 'Missing environment variables']
    },
    {
      title: 'Queue Not Processing',
      solution: 'Check Supervisor: sudo supervisorctl status zuora-workflows-queue:*',
      fix: 'sudo supervisorctl restart zuora-workflows-queue:*'
    },
    {
      title: 'Assets Not Loading',
      solution: 'Clear and rebuild: php artisan view:clear && php artisan cache:clear && yarn run build'
    }
  ]}
/>

## Scaling Considerations

### Horizontal Scaling

<InfoCards
  cards={[
    { title: 'Load Balancer', description: 'Use Nginx or HAProxy' },
    { title: 'Multiple Servers', description: 'Horizontal scaling with shared database' },
    { title: 'Redis Cluster', description: 'For cache and queue scalability' }
  ]}
/>

### Performance Optimization

<Checklist
  items={[
    'Enable OPcache',
    'Use Redis for cache and queue',
    'Implement CDN for assets',
    'Enable HTTP/2',
    'Optimize database queries'
  ]}
/>

<NextSteps
  links={[
    { title: 'Getting Started Guide', href: '../guides/getting-started', description: 'Initial setup' },
    { title: 'Configuration Reference', href: '../reference/configuration', description: 'Configure production settings' },
    { title: 'Features Guide', href: '../guides/features', description: 'Learn about features' }
  ]}
/>

## Related Documentation

<LinksGrid
  links={[
    { title: 'Laravel Deployment', url: 'https://laravel.com/docs/12.x/deployment', icon: 'ðŸ“š' },
    { title: 'Laravel Forge', url: 'https://forge.laravel.com', icon: 'ðŸ”§' },
    { title: 'Nginx Configuration', url: 'https://nginx.org/en/docs/', icon: 'ðŸŒ' },
    { title: 'Supervisor Documentation', url: 'http://supervisord.org/', icon: 'âš™ï¸' }
  ]}
/>
